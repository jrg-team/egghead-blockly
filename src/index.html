<!DOCTYPE html>
<html>

<head>
  <link rel="icon" type="image/ico" href="media/app.ico" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>蛋头拖拽编程</title>
  <!-- JavaScript -->
  <script src="js/jquery.min.2.1.3.js" onload="window.$ = window.jQuery"></script>
  <script type="text/javascript" src="js/blockly.min.js"></script>
  <script type="text/javascript" src="js/type.js"></script>
  <script type="text/javascript" src="js/types.js"></script>
  <script type="text/javascript" src="js/typings.js"></script>
  <script type="text/javascript" src="js/generate_python.js"></script>
  <script type="text/javascript" src="js/generate_cpp.js"></script>
  <script type="text/javascript" src="js/blocklino.js"></script>
  <script type="text/javascript" src="js/boards.js"></script>
  <script type="text/javascript" src="js/bootstrap.toggle.min.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.3.3.6.js"></script>
  <script type="text/javascript" src="js/prettify.min.js"></script>
  <script type="text/javascript" src="blocs&generateurs/blockly_blocs.js"></script>
  <script type="text/javascript" src="blocs&generateurs/arduino_blocs.js"></script>
  <script type="text/javascript" src="blocs&generateurs/arduino_generateurs_cpp.js"></script>
  <script type="text/javascript" src="blocs&generateurs/arduino_generateurs_python.js"></script>
  <script type="text/javascript" src="blocs&generateurs/blockly_generateurs_cpp.js"></script>
  <script type="text/javascript" src="blocs&generateurs/blockly_generateurs_python.js"></script>
  <script type="text/javascript" src="blocs&generateurs/audio.js"></script>
  <script type="text/javascript" src="blocs&generateurs/analogkey.js"></script>
  <script type="text/javascript" src="blocs&generateurs/leds.js"></script>
  <script type="text/javascript" src="blocs&generateurs/RTTTL.js"></script>
  <script type="text/javascript" src="blocs&generateurs/sensors.js"></script>
  <script type="text/javascript" src="blocs&generateurs/softBT.js"></script>
  <script type="text/javascript" src="blocs&generateurs/SerialUSB.js"></script>
  <script type="text/javascript" src="blocs&generateurs/SoftwareSerial.js"></script>
  <script type="text/javascript" src="blocs&generateurs/OpenSmartMP3.js"></script>
  <script type="text/javascript" src="blocs&generateurs/MP3YX5300.js"></script>
  <script type="text/javascript" src="blocs&generateurs/ST7735.js"></script>
  <script type="text/javascript" src="blocs&generateurs/matrix.js"></script>
  <script type="text/javascript" src="blocs&generateurs/MAX7219.js"></script>
  <script type="text/javascript" src="blocs&generateurs/TCS34725.js"></script>
  <script type="text/javascript" src="blocs&generateurs/HMC5883.js"></script>
  <script type="text/javascript" src="blocs&generateurs/RFID.js"></script>
  <script type="text/javascript" src="blocs&generateurs/gyro.js"></script>
  <script type="text/javascript" src="blocs&generateurs/GPS.js"></script>
  <script type="text/javascript" src="blocs&generateurs/ESPFunctions.js"></script>
  <script type="text/javascript" src="blocs&generateurs/DisplayTM1637.js"></script>
  <script type="text/javascript" src="blocs&generateurs/RadioTEA5767.js"></script>
  <script type="text/javascript" src="blocs&generateurs/Lcd_I2C.js"></script>
  <script type="text/javascript" src="blocs&generateurs/Keyboard_and_mouse.js"></script>
  <script type="text/javascript" src="blocs&generateurs/APDS9960.js"></script>
  <script type="text/javascript" src="blocs&generateurs/mu_vision_sensor.js"></script>
  <script type="text/javascript" src="blocs&generateurs/remoteControl.js"></script>
  <script type="text/javascript" src="blocs&generateurs/RTC_DS3231.js"></script>
  <script type="text/javascript" src="blocs&generateurs/InternalRTC.js"></script>
  <script type="text/javascript" src="blocs&generateurs/html.js"></script>
  <script type="text/javascript" src="blocs&generateurs/otto.js"></script>
  <script type="text/javascript" src="blocs&generateurs/ottoesp.js"></script>
  <script type="text/javascript" src="blocs&generateurs/oled.js"></script>
  <script type="text/javascript" src="blocs&generateurs/encoder.js"></script>
  <script type="text/javascript" src="blocs&generateurs/motor.js"></script>
  <script type="text/javascript" src="blocs&generateurs/escornabot.js"></script>
  <script type="text/javascript" src="blocs&generateurs/neopixel.js"></script>
  <script type="text/javascript" src="blocs&generateurs/MQTT.js"></script>
  <script type="text/javascript" src="blocs&generateurs/Thingspeak.js"></script>
  <script type="text/javascript" src="blocs&generateurs/Firebase.js"></script>
  <script type="text/javascript" src="blocs&generateurs/Telegram.js"></script>
  <script type="text/javascript" src="blocs&generateurs/OpenWeather.js"></script>
  <script type="text/javascript" src="blocs&generateurs/IFTTT.js"></script>
  <script type="text/javascript" src="blocs&generateurs/NTP.js"></script>
  <script type="text/javascript" src="blocs&generateurs/WifiBasic.js"></script>
  <script type="text/javascript" src="blocs&generateurs/WifiServer.js"></script>
  <script type="text/javascript" src="blocs&generateurs/EspNow.js"></script>
  <script type="text/javascript" src="blocs&generateurs/Alexa.js"></script>
  <script type="text/javascript" src="blocs&generateurs/text.js"></script>
  <script type="text/javascript" src="js/typing.js"></script>
  <script type="text/javascript" src="lang/code.js"></script>
  <script type="text/javascript" src="js/hexlify.js"></script>
  <script type="text/javascript" src="js/intel-hex.browser.js"></script>
  <script type="text/javascript" src="js/ace.js"></script>
  <script type="text/javascript" src="js/ext-language_tools.js"></script>
  <script src="js/alpinejs.min.js" defer></script>
  <script src="js/handlers/store.js"></script>
  <script src="js/handlers/arduino.js"></script>
  <script src="js/beautify.min.js" defer></script>
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.min.3.3.6.css" />
  <link rel="stylesheet" type="text/css" href="css/bootstrap.extra.css" />
  <link rel="stylesheet" type="text/css" href="css/bootstrap.toggle.min.css" />
  <link rel="stylesheet" type="text/css" href="css/global.css" />
  <link rel="stylesheet" type="text/css" href="css/blocklino.css" />
  <link rel="stylesheet" type="text/css" href="css/prettify.min.css" />
</head>

<body onload="BlocklyDuino.init()" x-data="{ app: window.currentRunningPlatform === 'desktop' }">
  <div class="loading">
    <div class="loader"></div>
  </div>
  <div id="toptitle">
    <div id="title">
      <div class="img">
        <img src="media/icon.png" class="img-fluid" style="height: 30px;" alt="Logo" />
      </div>
    </div>
  </div>
  <div id="header">
      <ul class="nav nav-tabs" role="tablist" style="display: none">
        <li role="presentation" class="active">
          <a href="#content_blocks" aria-controls="content_blocks" role="tab" data-toggle="tab"></a>
        </li>
        <li role="presentation">
          <a href="#content_code" aria-controls="content_code" role="tab" data-toggle="tab"></a>
        </li>
      </ul>
      <span id="labelToolboxDefinition" style="color: white; font-weight: bold">
      </span>
      <div id="btn_group1" class="btn-group">
        <button id="btn_level1" class="btn btn-arduino-rect level">1</button>
        <button id="btn_level2" class="btn btn-arduino-rect level">2</button>
        <button id="btn_level3" class="btn btn-arduino-rect level">3</button>
      </div>
      <div class="header-divider"></div>
      <select id="languageMenu" onchange="BlocklyDuino.changelanguage();"
        style="height: 42px; border-radius: 5px; font-weight: bold"></select>
      <div class="header-divider"></div>
      <button id="btn_example" class="btn btn-arduino-rect" data-toggle="modal" data-target="#exampleModal"
        title="示例项目">
        <span class="fa fa-graduation"></span>
      </button>
      <div class="header-divider"></div>
      <!--	<span id="exampleModalLabel" style="color:white;font-size:4" > </span> -->
      <input id="title-project-name" type="text" placeholder="Project name" value="" />
      <button id="btn_saveXML" class="btn btn-arduino-rect" title="保存">
        <span class="fa fa-floppy-o fa-lg fa-fw"></span>
      </button>
      <button id="btn_new" class="btn btn-arduino-rect" title="新建项目">
        <span class="fa fa-file"></span>
      </button>
      <button id="btn_fakeload" class="btn btn-arduino-rect" title="打开文件">
        <span class="fa fa-folder-open"></span>
      </button>
      <input type="file" id="load" accept=".bloc,.xml,.py,.ino" style="display: none" />
      <button id="btn_undo" class="btn btn-arduino-rect" title="撤销">
        <span class="fa fa-undo"> </span>
      </button>
      <button id="btn_redo" class="btn btn-arduino-rect" title="重新执行">
        <span class="fa fa-repeat"> </span>
      </button>
      <div x-show="app" class="app-actions-wrapper">
        <div class="header-divider"></div>
        <button class="btn device-select-btn" :class="$store.devices.selected.port ? 'port-selected' : ''" @click="listDevices()"
          x-text="$store.devices.selected.port ? '切换设备' : '选择设备'" 
          :title="`端口: ${($store.devices.selected.port || {}).label || '未选择 ⚠️'} \n开发板: ${($store.devices.selected.board || {}).name ||  '未选择 ⚠️'}`"
          ></button>
        <div class="header-divider"></div>
        <button id="btn_verify_code" class="btn btn-arduino-rect" title="校验代码" @click="verifyCode">
          <span class="loader inline-loader" x-show="$store.processing.category === 'verify'"></span>
          <span class="fa fa-check" x-show="$store.processing.category !== 'verify'"> </span>
        </button>
        <button id="btn_upload" class="btn btn-arduino-rect" title="烧录代码" @click="uploadCode">
          <span class="loader inline-loader" x-show="$store.processing.category === 'upload'"></span>
          <span class="fa fa-arrow-right" x-show="$store.processing.category !== 'upload'"></span>
        </button>
        <button id="btn_monitor" class="btn btn-arduino-rect" :title="'串口监视器(' + (($store.devices.selected.port || {}).label || '未选择') + ')'" @click="openMonitor">
          <i class="fa fa-usb" aria-hidden="true"></i>
        </button>
      </div>
      <div id="btn_group" class="btn-group" role="group">
        <button id="btn_preview" class="btn btn-arduino-rect">
          <span class="fa fa-code"> </span>
        </button>
        <button id="btn_search" class="btn btn-arduino-rect">
          <span class="fa fa-binoculars"> </span>
        </button>
        <input id="codeORblock" checked data-size="small" data-toggle="toggle"
          data-on="<span class='fa fa-puzzle  fa-2x' ></span>" data-off="<span class='fa fa-code fa-2x'></span>"
          data-style="ios" data-onstyle="default" data-offstyle="default" type="checkbox" />
      </div>
    
  </div>
  <div id="divBody" class="tab-content">
    <div role="tabpanel" id="content_blocks" class="tab-pane fade in active" style="position: relative">
      <div id="toggle" class="modal-content" style="display: none">
        <pre id="pre_previewArduino"></pre>
        <div id="btn_group" class="btn-group-preview" role="group">
          <button id="btn_saveino" class="btn btn-default" title="保存到本地">
            <span class="fa fa-floppy-o"> </span>
          </button>
          <button id="btn_copy" class="btn btn-default" title="复制到剪贴板" @click="copyCode">
            <span class="fa fa-files-o"> </span>
          </button>
        </div>
      </div>
    </div>
    <div role="tabpanel" id="content_code" class="tab-pane fade">
      #enter your code here
    </div>
  </div>
  <!-- device select modal -->
  <div class="modal fade" id="device-select" tabindex="-1" role="dialog" aria-hidden="true" data-keyboard="false"
    data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-body">
          <div class="title" style="font-size: 18px; font-weight: bold;">选择开发板和端口</div>
          <div class="block-titles">
            <div class="title-board">开发板</div>
            <div class="title-ports">端口</div>
          </div>
          <div class="device-blocks">
            <div class="boards">
              <template x-for="board in $store.devices.boards">
                <div class="board" :class="$store.devices.isSelected('board', board) ? 'selected' : ''"
                  @click="$store.devices.select('board', board)">
                  <img x-bind:src="board.picture" />
                  <div class="name" x-text="board.name"></div>
                </div>
              </template>
            </div>
            <div class="ports">
              <template x-for="portDetail in $store.devices.ports">
                <div class="port" :class="$store.devices.isSelected('port', portDetail.port) ? 'selected' : ''"
                  @click="$store.devices.select('port', portDetail.port)">
                  <div class="port-label">
                    <span x-text="portDetail.port.label"></span>&nbsp;<span
                      x-text="portDetail.port.protocol_label"></span>
                  </div>
                  <span x-show="$store.devices.isSelected('port', portDetail.port)" class="selected-icon fa fa-check"
                    aria-hidden="true"></sp>
                </div>
              </template>
              <div x-show="$store.devices.fetching" class="fetching">
                <div class="loader" style="width: 24px; height: 24px; border-width: 3px;"></div>&emsp;读取中
              </div>
            </div>
          </div>
          <div class="device-actions">
            <button class="btn" @click="$store.devices.onDeviceConfirm">确认</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- message modal -->
  <div class="modal fade" id="message" tabindex="-1" role="dialog" aria-hidden="true" data-keyboard="false"
    data-backdrop="static">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-body">
          <div id="messageDIV"></div>
        </div>
      </div>
    </div>
  </div>
  <!-- example modal -->
  <div class="modal fade" id="exampleModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">
            <span aria-hidden="true">&#215;</span>
          </button>
          <span class="fa fa-file-text fa-2x" class="modal-title" id="exampleModalLabel"></span>
        </div>
        <div class="modal-body">
          <div class="table-responsive">
            <table class="table table-hover">
              <tbody id="includedContent"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="toast-wrapper">
    <template x-for="(message, index) in $store.messages.list">
      <div class="toast" :class="message.type" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
          <strong class="mr-auto" x-text="message.title"></strong>
          <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close" @click="$store.messages.remove(index)">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body" x-html="message.content"></div>
      </div>
    </template>
  </div>
  <script type="text/javascript">
    $(window).load(function () {
      $(".loading").fadeOut("slow");
    });
    ace.require("ace/ext/language_tools");
    var editor = ace.edit("content_code");
    editor.setTheme("ace/theme/sqlserver");
    editor.session.setTabSize(2);
    editor.setShowPrintMargin(false);
  </script>
</body>

</html>